[Промислові мережі та інтеграційні технології в автоматизованих системах](README.md). 4. [ТЕХНОЛОГІЇ МОДЕМНОГО ТА БЕЗПРОВОДНОГО ЗВ’ЯЗКУ](4.md)

## 4.2. Модемний обмін

Модем (скорочення від модулятор-демодулятор) — пристрій зв'язку, що виконує функцію модуляції та демодуляції. Модуляція – це зміна характеристик несучого сигналу у відповідності зі зміною вхідного інформаційного сигналу, демодуляція – зворотній процес.. 

До критеріїв класифікації модемів можна віднести наступні: область застосування; функціональне призначення; тип використовуваного каналу; конструктивне виконання; підтримка протоколів модуляції, виправлення помилок і стиснення даних. Можна виділити ще безліч більш детальних технічних ознак, таких як спосіб модуляції, інтерфейс сполучення з DTE і так далі. 

За способом реалізації каналу, модеми можна поділити на такі групи:

- для комутованих телефонних каналів; 

- для виділених телефонних каналів;

- для фізичних з'єднувальних ліній: 

  - модеми низького рівня (лінійні драйвери) або модеми на коротку відстань (short range modems); 

  - модеми основної смуги (baseband modems); 

- для цифрових систем передачі (CSU/DSU);

- для стільникових систем зв'язку; 

- для пакетних радіомереж; 

- для локальних радіомереж.

Переважна більшість модемів, що випускаються призначена для використання на комутованих телефонних каналах. Такі модеми повинні вміти працювати з автоматичними телефонними станціями (АТС), розрізняти їх сигнали і передавати свої сигнали набору номера.

Основна відмінність модемів для фізичних ліній від інших типів модемів полягає в тому, що смуга пропускання фізичних ліній не обмежена значенням 3,1 кГц, характерним для телефонних каналів. Однак смуга пропускання фізичної лінії також є обмеженою і залежить головним чином від типу фізичного середовища (екранована і неекранована вита пара, коаксіальний кабель тощо) і її довжини. З погляду використовуваних для передачі сигналів модеми для фізичних ліній можуть бути розділені на модеми низького рівня (лінійні драйвери), що використовують цифрові сигнали, і модеми "основної смуги" (baseband), у яких застосовуються методи модуляції, аналогічні вживаним в модемах для телефонних каналів. У модемах першої групи зазвичай використовуються цифрові методи бі-імпульсної передачі, що дозволяють формувати імпульсні сигнали без постійної складової і часто займають більш вузьку смугу частот, ніж вихідна цифрова послідовність. У модемах другої групи часто використовуються різні види квадратурної амплітудної модуляції, що дозволяють радикально скоротити необхідну для передачі смугу частот. У результаті на однакових фізичних лініях такими модемами може досягатися швидкість передачі до 100 Кбіт/с, у той час як модеми низького рівня забезпечують тільки 19,2 Кбіт/с.

Модеми для цифрових систем передачі нагадують модеми низького рівня. Однак на відміну від них забезпечують підключення до стандартних цифрових каналах, таким як Е1/Т1 або ISDN, і підтримують функції відповідних канальних інтерфейсів. 

Модеми для стільникових систем зв'язку відрізняються компактністю виконання і підтримкою спеціальних протоколів модуляції і виправлення помилок, що дозволяють ефективно передавати дані в умовах стільникових каналів з високим рівнем перешкод і постійно змінюваними параметрами.

Пакетні радіомодеми призначені для передачі даних по радіоканалу між мобільними користувачами. При цьому декілька радіомодемів використовують один і той же радіоканал в режимі множинного доступу. Радіоканал по своїх характеристиках близький до телефонного і організовується з використанням типових радіостанцій, налаштованих на одну і ту ж частоту. Пакетний радіомодем реалізує методи модуляції і множинного доступу. 

Локальні радіомережі є перспективною мережною технологією, що доповнює звичайні локальні мережі. Основним їх елементом є спеціалізовані радіомодеми (адаптери локальних радіомереж). На відміну від пакетних радіомодемів такі модеми забезпечують передачу даних на невеликі відстані (до 300 м) з високою швидкістю (10 Мбіт/с), зіставною із швидкістю передачі в дротяних локальних мережах. Крім того, радіомодеми локальних радіомереж працюють в певному діапазоні частот із застосуванням сигналів складної форми, таких як сигнали з псевдовипадковою перебудовою робочої частоти.

В промислових системах управління актуальним є використання останніх трьох груп модемів.

В окремий клас можна виділити промислові модеми, що крім промислових умов експлуатації ще можуть підтримувати наступні функції:

- багатофункціональний інтерфейс, тобто наявність декількох каналів зв’язку (RS232, RS485, USB);

- можливість подавати на вхід модему через послідовний COM-порт RS232 аналоговий сигнал безпосередньо з виконавчих пристроїв (датчиків, контролерів) завдяки наявності вбудованого 10-розрядного аналого-цифрового перетворювача;

- обробка і керування аналогових сигналів завдяки наявності спеціальних вводів-виводів;

- наявність великого об’єму пам’яті для аварійних повідомлень, завдяки наявності FLASH-пам'яті;

- наявність відкритої перепрограмуємої платформи, що дозволяє розробникам бездротового обладнання створювати гнучкі рішення і завантажувати користувальницьке ПО прямо в FLASH-пам'ять модему;

- вбудований TCP/IP-стек, що дозволяє не застосовувати додаткове обладнання для передачі файлів і роботи з електронною поштою;

- віддалені настройку, конфігурацію та дистанційний моніторинг модему.

Для управління модемом використовують АТ-команди представлені рядками символів, що починаються з літер AT (ATtention - увага)  і завершуються символом повернення каретки (<CR>) (іноді у рядку ініціалізації модему кінцевий символ формується автоматично). Символи команд можуть бути прописними або малими, між командами можуть бути присутні або відсутні пробіли. АТ-команди, крім виконання прямих дій з переключення режиму модему, управляють S-регістрами модему, в яких міститься службова інформація, потрібна для роботи. Наприклад, в S-регістрах зберігаються константи, що визначають час очікування дзвінка, типи використовуваних протоколів, рівень вихідного і вхідного сигналів, аналогові сигнали і т. п. Кількість S-регістрів визначається розробником модему і може складати декілька сотень. Але прийнято, що за першими 13-ма S-регістрами зберігається призначення, введене фірмою Hayes. Вміст S-регістрів користувач може зчитувати і модифікувати на свій розсуд, але слід пам'ятати, що між значеннями в різних S-регістрах є складний взаємозв'язок. Крім того, довільне зміна будь-якого S-регістра може призвести до неможливості використання стандартних програм для роботи в Інтернеті.  

Основні АТ-команди наведені в табл. 4.1, сесію починають з команди АТ і якщо є зв’язок модем відповідає ОК.

Таблиця 4.1.  Основні АТ-команди модемів

| Команда  | Опис                                                         |
| -------- | ------------------------------------------------------------ |
| **+++**  | Модем розриває  з’єднання і повертається у командний режим   |
| **A**    | Команда відповіді (Answer  Command)                          |
| **Bn**   | Налаштування зв’язку  (Communications Options)               |
| **D**    | Команда набору (Dial  Command)                               |
| **En**   | Команда вибору ехо-символу (Select Command  Character Echo Option) |
| **Hn**   | Управління Switchhook -  емуляція натиснення телефонного важелю (Control The Switchhook) |
| **I0**   | Ідентифікація коду продукту  (Identify The Product Code)     |
| **I2**   | Виконання тесту контрольної  суми ROM ( Perform ROM Checksum Test) |
| **I7**   | Номер версії (Version  Number)                               |
| **Ln**   | Вибір рівня гучності  динаміку (Select Speaker Volume Level) |
| **Mn**   | Функція вибору опцій динаміку (Select Speaker Function Option) |
| **Nn**   | Вибір опцій для  встановлення зв’язку (Select Negotiate Handshake Option) |
| **On**   | Перехід до онлайнових  команд (Go Online Command)            |
| **P**    | Вибір методів пульсуючого  набору (Select Pulse Dialing Method) |
| **Qn**   | Вибір опції результуючого  коду (Select Result Code Option)  |
| **Sn=**  | Запис в S-регістр (Write To An  S-Register)                  |
| **Sn?**  | Читання S-регістру (Read An S-Register)                      |
| **T**    | Вибір методу тонового  набору (Select Tone Dialing Method)   |
| **Vn**   | Вибір опції формату  відповіді (Select Response Format Option) |
| **Wn**   | Вибір розширеного  результуючого коду (Select Extended Result Code) |
| **Xn**   | Вибір опції модемного виклику (Select Call Progress Option)  |
| **Yn**   | Вибір опції бездіяльності  та роз’єднання (Select Long Space Disconnect Option) |
| **Zn**   | Виконання м’якого скидання  (Perform Soft Reset)             |
| **&An**  | Вибір ролі автовідповідача (Select  Originate/Answer Role For Autoanswer) |
| **&Cn**  | Вибір опції визначення переданих  даних (Select Data Carrier Detect Option) |
| **&Dn**  | Вибір опції готовності  терміналу даних (Select Data Terminal Ready Option) |
| **&F**   | Загрузка заводських  установок (Load Factory Default Profile) |
| **&Gn**  | Вибір опції захисту  тонового набору (Select Guard Tone Option) |
| **&Kn**  | Вибір опції потоку ConTDol (Select  Flow ConTDol Option)     |
| **&Pn**  | Вибір параметрів пульсового  набору (Select Pulse Dialing Parameters) |
| **&Qn**  | Вибір опції режиму  зв’язку (Select Communications Mode Option) |
| **&Rn**  | Вибір опції RTS/CTS (Select RTS/CTS Option)                  |
| **&Sn**  | Вибір опції готовності  передачі даних (Select Data Set Ready Option) |
| **&T0**  | Тест завершення в процесі (Terminate Test In Process)        |
| **&T1**  | Ініціювання локального  аналогу мережної петлі (Initiate Local Analog Loopback) |
| **&T3**  | Виконання локальної  цифрової мережної петлі (Perform Local Digital Loopback) |
| **&T4**  | Включення RDL-запитів  (Enable Granting Of RDL Requests)     |
| **&T5**  | Заборона надання  RDL-запитів (Deny Granting Of RDL Requests) |
| **&T6**  | Ініціювання віддаленої  цифрової мережної петлі (Initiate Remote Digital Loopback) |
| **&T7**  | Ініціювання внутрішнього тесту RDL (Initiate RDL With  Self Test) |
| **&T8**  | Внутрішній тест локальної  мережної петлі (Local Loopback With Self Test) |
| **&T19** | Виконання тесту RTS/CTS кабелю (Perform RTS/CTS Cable Test)  |
| **&Un**  | Скасування TDellis кодування (Disable TDellis Coding)        |
| **&V**   | Перегляд профілів конфігурації (View  Configuration Profiles) |
| **&Wn**  | Збереження активного  профілю (Store Active Profile)         |
| **&Xn**  | Вибір джерела синхронізації  часу TDansmit (Store Active Profile) |
| **&Yn**  | Вибір збереження профілю  для апаратного перезапуску (Select Stored Profile For Hard Reset) |
| **&Zn=** | Збереження телефонного  номеру (Store Telephone Number)      |
| **,**    | Пауза (Perform Pause)                                        |
| **=**    | Запис в S-регістр (Write To An  S-Register)                  |
| **?**    | Читання S-регістру (Read An S-Register)                      |
| **P**    | Вибір пульсового набору (Select  Pulse Dialing)              |
| **Т**    | Тоновий набір (Tone)                                         |

Приклад 4.1. АТ-команди. Обмін SMS-повідомленнями через HyperTerminal. 

Завдання. Налаштувати бездротовий GSM-модем фірми Wavecom та ініціалізувати обмін між персональним компютером та стільниковим телефоном за допомогою HyperTerminal (рис.4.4).

![img](file:///C:\Users\san\AppData\Local\Temp\msohtmlclip1\01\clip_image001.gif)

Рис.4.4. До прикладу 4.1.

Рішення. GSM-модем Wavecom оснащений інтерфейсом RS-232, тому з’єднання між ПК та модемом (М) виконується нуль-модемним кабелем. Налаштування та обмін даними за допомогою АТ-команд, що вводяться через HyperTerminal та відповіді модему наведені в табл.4.2.

Таблиця 4.2. Набір АТ-команд до прикладу 4.2

| команда                                                     | Опис                                                         |
| ----------------------------------------------------------- | ------------------------------------------------------------ |
| AT                                                          | ПК:  увага                                                   |
| OK                                                          | М(модем): так                                                |
| AT+CBST?                                                    | ПК: запит на вибір типу носія: режими  швидкості, стиснення даних, прозорості |
| +CBST: 0,0,1                                                | М: 0 – швидкість автоматична, 0 –  стиснення відсутнє, 1 - непрозорий |
| OK                                                          | М: так                                                       |
| AT+CBST=7,0,1                                               | ПК: запит на підтримання носія                               |
| OK                                                          | М: так, підтримується                                        |
| AT+CBST=12,0,1                                              | ПК: встановлення швидкості – 9600 біт/с                      |
| OK                                                          | М: так                                                       |
| AT+IFC?                                                     | ПК: запит команди  управління місцевим потоком <DCE_by_DTE> та <DTE_by_DCE> |
| +IFC: 0,0                                                   | М: не підтримується, не підтримується                        |
| OK                                                          | М: так                                                       |
| AT&W                                                        | ПК: запис поточних  на лаштувань в EEPROM                    |
| OK                                                          | М: так, записано                                             |
| +CMTI: "SM",1                                               | М: отримано нове повідомлення, індекс 1                      |
| AT+CMGF=1                                                   | ПК: встановлення текстового режиму                           |
| OK                                                          | М: так, встановлено                                          |
| AT+CMGR=1                                                   | ПК: читати перше повідомлення                                |
| +CMGR: "REC UNREAD","+380669572528",,"09/05/18,14:09:28+12" | М: непрочитане повідомлення з номеру  телефону +380669572528 отримано 09/05/18 о 14:09:28 |
| Hello                                                       | М: текст повідомлення                                        |
| OK                                                          | М: так                                                       |
| AT+CMGL="REC UNREAD"                                        | ПК: показати непрочитані повідомлення в  текстовому режимі   |
| OK                                                          | М: так, ця відповідь визначає, що  непрочитаних повідомлень не має |
| AT+CMGR=2                                                   | ПК: читати друге повідомлення                                |
| ERROR                                                       | М: помилка – другого повідомлення не  виявлено               |
| AT+CMGR=1                                                   | ПК: знову читати перше повідомлення                          |
| +CMGR: "REC READ","+380669572528",,"09/05/18,14:09:28+12"   | М: прочитане повідомлення з номеру  телефону +380669572528 отримано 09/05/18 о 14:09:28 |
| Hello                                                       | М: текст повідомлення                                        |
| OK                                                          | М: так                                                       |
| AT+CMGS=+380669572528                                       | ПК: Відіслати повідомлення в текстовому  режимі на номер +380669572528 |
| > HELLOW(à)                                                 | ПК: текст повідомлення                                       |
| +CMGS: 23                                                   | М: повідомлення відіслано, номер  повідомлення 23 (визначається виробником) |
| OK                                                          | М: так                                                       |

 

<-- 4.1. [Символьний спосіб обміну](4_1.md) 

--> 4.3. [Бездротовий спосіб обміну](4_3.md) 